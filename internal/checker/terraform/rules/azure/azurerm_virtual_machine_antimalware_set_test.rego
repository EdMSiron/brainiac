package lib.terraform.CB_TFAZR_240

test_azurerm_virtual_machine_antimalware_set_passed {
	result := passed with input as [
		{
			"Type": "resource",
			"Labels": [
				"azurerm_virtual_machine",
				"virtual_machine_good_1",
			],
			"Attributes": {
				"location": "location",
				"name": "acctvm",
				"network_interface_ids": ["id"],
				"resource_group_name": "group",
				"vm_size": "Standard_F2",
			},
			"Blocks": [{
				"Type": "storage_os_disk",
				"Labels": [],
				"Attributes": {
					"caching": "ReadWrite",
					"create_option": "FromImage",
					"name": "myosdisk1",
				},
				"Blocks": [],
				"line_range": {
					"endLine": 11,
					"startLine": 7,
				},
			}],
			"line_range": {
				"endLine": 12,
				"startLine": 1,
			},
		},
		{
			"Type": "resource",
			"Labels": [
				"azurerm_virtual_machine_extension",
				"extension_good_1",
			],
			"Attributes": {
				"auto_upgrade_minor_version": true,
				"name": "hostname",
				"publisher": "Microsoft.Azure.Security",
				"type": "IaaSAntimalware",
				"type_handler_version": "2.0",
				"virtual_machine_id": "azurerm_virtual_machine.virtual_machine_good_1.id",
			},
			"Blocks": [],
			"line_range": {
				"endLine": 22,
				"startLine": 15,
			},
		},
	]
	count(result) == 1
}

test_azurerm_virtual_machine_antimalware_set_failed {
	result := failed with input as [
		{
			"Type": "resource",
			"Labels": [
				"azurerm_virtual_machine",
				"virtual_machine_good_1",
			],
			"Attributes": {
				"location": "location",
				"name": "acctvm",
				"network_interface_ids": ["id"],
				"resource_group_name": "group",
				"vm_size": "Standard_F2",
			},
			"Blocks": [{
				"Type": "storage_os_disk",
				"Labels": [],
				"Attributes": {
					"caching": "ReadWrite",
					"create_option": "FromImage",
					"name": "myosdisk1",
				},
				"Blocks": [],
				"line_range": {
					"endLine": 11,
					"startLine": 7,
				},
			}],
			"line_range": {
				"endLine": 12,
				"startLine": 1,
			},
		},
		{
			"Type": "resource",
			"Labels": [
				"azurerm_virtual_machine_extension",
				"extension_good_1",
			],
			"Attributes": {
				"auto_upgrade_minor_version": true,
				"name": "hostname",
				"publisher": "",
				"type": "",
				"type_handler_version": "2.0",
			},
			"Blocks": [],
			"line_range": {
				"endLine": 22,
				"startLine": 15,
			},
		},
	]
	count(result) == 1
}
